<h3>Update Profile</h3>
<hr />
<form [formGroup]="profileForm" (ngSubmit)="onUpdate()">
  <mat-form-field appearance="fill">
    <mat-label>First Name</mat-label>
    <input matInput type="text" formControlName="firstName" />
    <mat-error
      *ngIf="
        profileForm.get('firstName')?.errors &&
        (profileForm.get('firstName')!.dirty ||
          profileForm.get('firstName')!.touched)
      "
    >
      <div *ngIf="profileForm.get('firstName')?.errors?.required">
        First name is required
      </div>
      <div *ngIf="profileForm.get('firstName')?.errors?.minlength">
        First name is too short
      </div>
      <div *ngIf="profileForm.get('firstName')?.errors?.maxlength">
        First name is too long
      </div>
    </mat-error>
  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>Last Name</mat-label>
    <input matInput type="text" formControlName="lastName" />
    <mat-error
      *ngIf="
        profileForm.get('lastName')?.errors &&
        (profileForm.get('lastName')!.dirty ||
          profileForm.get('lastName')!.touched)
      "
    >
      <div *ngIf="profileForm.get('lastName')?.errors?.required">
        First name is required
      </div>
      <div *ngIf="profileForm.get('lastName')?.errors?.minlength">
        First name is too short
      </div>
      <div *ngIf="profileForm.get('lastName')?.errors?.maxlength">
        First name is too long
      </div>
    </mat-error>
  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>Birthday</mat-label>
    <input matInput [matDatepicker]="picker" formControlName="birthday" />
    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
    <mat-datepicker #picker></mat-datepicker>
  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>phone</mat-label>
    <input matInput type="number" formControlName="phone" />
  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>Nationality</mat-label>
    <mat-select formControlName="nationality" (change)="selectNat($event)">
      <mat-option [disabled]="true" value="null"
        >Select a nationality</mat-option
      >
      <mat-option
        *ngFor="let nationality of nationalities"
        [value]="nationality"
      >
        {{ nationality }}
      </mat-option>
    </mat-select>
    <mat-error
      *ngIf="
        profileForm.get('nationality')?.errors &&
        (profileForm.get('nationality')!.dirty ||
          profileForm.get('nationality')!.touched)
      "
    >
      <div *ngIf="profileForm.get('nationality')?.errors?.required">
        nationality is required
      </div>
    </mat-error>
  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>NIF</mat-label>
    <input matInput type="text" formControlName="nif" />
    <mat-error
      *ngIf="
        profileForm.get('nif')?.errors &&
        (profileForm.get('nif')!.dirty || profileForm.get('nif')!.touched)
      "
    >
      <div *ngIf="profileForm.get('nif')?.errors?.required">
        nif is required
      </div>
    </mat-error>
    <div *ngIf="profileForm.errors?.errorNIF">nif isn't ok</div>
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>About</mat-label>
    <textarea matInput cols="38" rows="5" formControlName="about"></textarea>
  </mat-form-field>
  <div *ngIf="(profileType$ | async) === 'company'">
    <mat-form-field appearance="fill">
      <mat-label>Company Name</mat-label>
      <input matInput type="text" formControlName="companyName" />
      <mat-error
        *ngIf="
          profileForm.get('companyName')?.errors &&
          (profileForm.get('companyName')!.dirty ||
            profileForm.get('companyName')!.touched)
        "
      >
        <div *ngIf="profileForm.get('companyName')?.errors?.required">
          company name is required
        </div>
        <div *ngIf="profileForm.get('companyName')?.errors?.minlength">
          company name is too short
        </div>
        <div *ngIf="profileForm.get('companyName')?.errors?.maxlength">
          company name is too long
        </div>
      </mat-error>
    </mat-form-field>
    <mat-form-field appearance="fill">
      <mat-label>Company Description</mat-label>
      <textarea
        matInput
        cols="38"
        rows="5"
        formControlName="companyDescription"
      ></textarea>
    </mat-form-field>
    <mat-form-field appearance="fill">
      <mat-label>CIF</mat-label>
      <input matInput type="text" formControlName="cif" />
      <mat-error
        *ngIf="
          profileForm.get('cif')?.errors &&
          (profileForm.get('cif')!.dirty || profileForm.get('nif')!.touched)
        "
      >
        <div *ngIf="profileForm.get('cif')?.errors?.required">
          cif is required
        </div>
      </mat-error>
    </mat-form-field>
  </div>

  <button
    mat-raised-button
    color="primary"
    type="submit"
    [disabled]="!profileForm.valid"
  >
    Confirm
  </button>
  <button mat-raised-button type="submit" [routerLink]="['/profile']">
    Cancel
  </button>
</form>
